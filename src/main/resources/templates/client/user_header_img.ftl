<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="UTF-8"><title>头像设置</title><link rel="shortcut icon" href="/client/images/tianya.ico"><link rel="stylesheet" type="text/css" href="/client/css/base.css"><link rel="stylesheet" type="text/css" href="/client/css/common.css"><link rel="stylesheet" type="text/css" href="/client/css/index.css"><link rel="stylesheet" type="text/css" href="/client/css/person_center.css"><link rel="stylesheet" type="text/css" href="/client/css/uploadavater.css"><script type=text/javascript src="/client/js/jquery.min.js"></script><script type=text/javascript src="/client/js/jquery-1.11.0.js"></script><script type=text/javascript src="/client/js/rich_lee.js"></script><script type="text/javascript" src="/client/js/cropbox.js"></script><script>    $(window).load(function() {        var defalutavater="/client/images/defaultavartar.jpg";        var useravater="";        //判断是否用户是否有当前头像 有就加载        if(useravater==""){            $('.cropped').html('');            $('.cropped').append('<div><img src="'+defalutavater+'" align="absmiddle" style="width:180px; height:180px;margin-top:4px;"><p>180px*180px</p></div>');            <!--$('.cropped').append('<div><img src="'+defalutavater+'" align="absmiddle" style="width:100px; height:100px;margin-top:4px;"><p>100px*100px</p></div>');-->            <!--$('.cropped').append('<div><img src="'+defalutavater+'" align="absmiddle" style="width:50px; height:50px;margin-top:4px;" ><p>50px*50px</p></div>');-->        }else{            $('.cropped').html('');            $('.cropped').append('<div><img src="'+useravater+'" align="absmiddle" style="width:180px; height:180px;margin-top:4px;"><p>180px*180px</p></div>');            <!--$('.cropped').append('<div><img src="'+useravater+'" align="absmiddle" style="width:100px; height:100px;margin-top:4px;"><p>100px*100px</p></div>');-->            <!--$('.cropped').append('<div><img src="'+useravater+'" align="absmiddle" style="width:50px; height:50px;margin-top:4px;" ><p>50px*50px</p></div>');-->        }        var options = {            thumbBox: '.thumbBox',            spinner: '.spinner',            imgSrc: '/client/images/defaultavartar.jpg'        }        var cropper = $('.imageBox').cropbox(options);        $('#upload-file').on('change', function(){            var reader = new FileReader();            reader.onload = function(e) {                options.imgSrc = e.target.result;                cropper = $('.imageBox').cropbox(options);            }            reader.readAsDataURL(this.files[0]);            this.files = [];        })        $('#btnCrop').on('click', function(){            var img = cropper.getDataURL();            $('.cropped').html('');            $('.cropped').append('<div><img src="'+img+'" align="absmiddle" style="width:180px; height:180px;margin-top:4px;"><p>180px*180px</p></div>');            <!--$('.cropped').append('<div><img src="'+img+'" align="absmiddle" style="width:100px; height:100px;margin-top:4px;"><p>100px*100px</p></div>');-->            <!--$('.cropped').append('<div><img src="'+img+'" align="absmiddle" style="width:50px; height:50px;margin-top:4px;" ><p>50px*50px</p></div>');-->        })        $('#btnZoomIn').on('click', function(){            cropper.zoomIn();        })        $('#btnZoomOut').on('click', function(){            cropper.zoomOut();        })                $('#saveId').on('click', function(){            var img = $("#img div img").attr("src");            if(img == "/client/images/defaultavartar.jpg"){            	alert("请选择上传的头像");            	return;            }            $.ajax({                type: "post",                url: "/user/header/img/save",                               data: {"img": img},                dataType: "json",                success: function (data) {                     if (data.code == 0){                    	alert("上传成功！");                        window.location.href="/user/0";                    }                    }            });        })    });        </script><body><#include "/client/common_header.ftl" /><!-- ********************中间内容******************** --><div class="percenter_com my_colection">    <#include "/client/common_user_header.ftl" />    	<#include "/client/common_user_menu.ftl" />    <!-- **********中间-右边********** -->    <div class="body_right">        <div class="right_title">头像设置</div>        <div class="avatar">            <div class="div_avatar">                <div class="imageBox">                    <div class="thumbBox"></div>                    <div class="spinner" style="display: none">Loading...</div>                </div>                <div class="action">                    <div class="new-contentarea tc">                        <a href="javascript:void(0)" class="upload-img"><label for="upload-file">选择图像</label></a>                        <input type="file" class="" name="upload-file" id="upload-file" />                    </div>                    <input type="button" id="btnCrop"  class="Btnsty_peyton" value="裁切">                    <input type="button" id="btnZoomIn" class="Btnsty_peyton" value="+"  >                    <input type="button" id="btnZoomOut" class="Btnsty_peyton" value="-" >                </div>                <div class="cropped" id="img"></div>            </div>        </div>		<div class="add_savebtn">            <input type="button" value="保存" id="saveId"/>        </div>    </div>    <!-- **********中间-右边-结束********** --></div><!-- ********************中间内容-结束******************** --><div class="h20"></div><#include "/client/common_footer.ftl" /></body></html>